---
title: 任意用户密码重置
date: 2019-04-28 10:28:31
tags: 密码找回
categories: 渗透测试
---

# 0x01 前言

很久没更新blog，今天描述一下数月前工作中无意间发现的一次比较经典的重置任意用户密码的实例。攻击手段比较简单，简单描述一下。
<!-- more -->
# 0x02 漏洞描述

登录页面如下：
![](2019-04-28-任意用户密码重置\登录口.png)

 查看登录页面发现忘记密码有两种找回方式：
 1. 短信找回密码
 2. 邮箱找回密码

 此处关注短信找回密码，邮箱找回问题暂不描述。

## 第一次检测
 点击短信找回密码，输入任意工号：
 ![](2019-04-28-任意用户密码重置\短信找回密码.png)

此时发现接收验证码手机号可修改，修改成自己手机号进行验证：
 ![](2019-04-28-任意用户密码重置\修改手机号.png)

成功进入设置新密码界面。
![](2019-04-28-任意用户密码重置\设置新密码.png)

提交漏洞报告给相关部门进行修改。

## 第二次检测
修改后对漏洞进行复查，此时拥有一个已知账户关联的手机号。

同样使用短信找回密码，输入已知账户工号进行密码找回，此时为修改后指定手机号进行验证，无法修改。
![](2019-04-28-任意用户密码重置\指定手机号.png)

验证时抓包，修改账户工号ID为任意用户：
![](2019-04-28-任意用户密码重置\修改ID.png)

此时同样进入到设置新密码界面。设置后成功登录修改的账户。
